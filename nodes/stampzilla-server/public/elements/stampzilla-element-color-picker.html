<link rel="import" href="/bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="/bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="/bower_components/core-animated-pages/transitions/slide-down.html">
<link rel="import" href="/bower_components/core-animated-pages/transitions/slide-up.html">
<link rel="import" href="/bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="/bower_components/font-roboto/roboto.html">
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/core-scaffold/core-scaffold.html">
<link rel="import" href="/bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="/bower_components/core-menu/core-menu.html">
<link rel="import" href="/bower_components/core-item/core-item.html">
<link rel="import" href="/bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="/bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="/bower_components/core-menu/core-submenu.html">
<link rel="import" href="/bower_components/paper-slider/paper-slider.html">
<link rel="import" href="/bower_components/color-picker-element/dist/color-picker.html">

<polymer-element name="stampzilla-element-color-picker" attributes="device element1" >
	<template>
		<!--<link rel="stylesheet" href="stampzilla-default-elements.css">-->

		<style>
			.card {
				margin:10px;
			}

			.card div {
				padding:10px;
			}
		</style>

		<div horizontal layout class="card">
			<paper-shadow z="1"></paper-shadow>
			<div style="width:200px;">
				<color-picker on-colorselected="{{colorSelected}}" width="200" height="200"></paper-slider>
			</div>
			<div flex>{{element1.Name}}</div>
			<div>COLORPICKER</div>
		</div>
	</template>
	<script>
		/* jshint newcap: false */
		/*global Polymer */


		(function() {
			"use strict";

			Polymer('stampzilla-element-color-picker', {
				element: {},
				device: {},
				state: false,
				deviceChanged: function(){
					if( this.device.State === undefined){
						return;
					}
					console.log("device changed");
					//console.log(this.device.State);
					//console.log(this.element1.Feedback);
					try{
						this.state = eval("this.device.State."+this.element1.Feedback);
					}catch(e){
						if(e.message === 'Cannot read property \'State\' of undefined'){
							return;
						}
						console.log(e);
					}
					//console.log(this.state);
				},
				elementChanged: function(){
					console.log("element changed",this.element);
				},
				colorSelected: function (e){
					this.element1.Command.params = [
						e.detail.hex,
						e.detail.rgb.r+"",
						e.detail.rgb.g+"",
						e.detail.rgb.b+""
					];

					var cmd = {
						type:'cmd',
						to:this.device.Uuid,
						data:this.element1.Command
					};
					this.fire('stampzilla-send-to-server', cmd);

                   // console.log(e.detail.hex + ' (r=' + e.detail.rgb.r + ', g=' + e.detail.rgb.g + ', b=' + e.detail.rgb.b + ')');
				},


				ready: function(){

                }
			});


			//{
			//	Type: 1,
			//	Name: "Example button",
			//	Command: {
			//		cmd: "set",
			//		args: [
			//			"1"
			//		]
			//	},
			//	Feedback: "Devices[1].State"
			//},

		})();
	</script>
</polymer-element>
