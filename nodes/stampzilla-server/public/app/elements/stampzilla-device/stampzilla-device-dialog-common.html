<link rel="import" href="../../bower_components/iron-form/iron-form.html">

<dom-module id="stampzilla-device-dialog-common">
	<template>
		<style  is="custom-style">
			:host {
				@apply(--layout-vertical);
			    @apply(--layout-wrap);
			}

		</style>
		<form is="iron-form" id="form">
			<paper-input label="Name" name="name" value="[[device.name]]"></paper-input>
			<paper-input label="Tags (space sepparated)" name="tags" value="[[device.tags]]"></paper-input>
			<paper-button id="save" raised><iron-icon icon="icons:save"></iron-icon> Save</paper-button>
		</form>
	</template>

	<script>
		(function () {
			Polymer({
				is: 'stampzilla-device-dialog-common',
				properties: {
					device: {
						type: Object,
						notify: true,
						observer: 'deviceChanged'
					}
				},
				deviceChanged: function() {
					// console.log(this.device);
				},
				listeners: {
					'save.click': 'save',
					'form.iron-form-presubmit': 'presubmit'
				},
				presubmit: function(event) {
					event.preventDefault();

					var pkg = {
						type: 'devices/set',
						data: this.$.form.serialize()
					};
					pkg.data.uuid = this.device.node+"."+this.device.id;

					app.fire('ws-send', pkg);

					this.fire('stampzilla-dialog-dismiss')
				},
				save: function() {
					this.$.form.submit();
				}
			});
		})();
	</script>

</dom-module>
